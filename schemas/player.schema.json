{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://github.com/wpinrui/table-tennis/schemas/player.schema.json",
  "title": "Player",
  "description": "A table tennis player with skill attributes, equipment, per-side stroke capabilities, stroke/serve tendencies, and an optional custom decision engine. Each player is a separate JSON file in the /players/ folder. Files can be hand-authored or AI-generated.",
  "type": "object",
  "required": ["name", "handedness", "attributes", "equipment", "strokeCapabilities", "strokeTendencies", "serveTendencies"],
  "additionalProperties": false,
  "properties": {
    "name": {
      "type": "string",
      "description": "Player's display name. Must be unique across all player files.",
      "minLength": 1
    },
    "handedness": {
      "type": "string",
      "enum": ["left", "right"],
      "description": "Playing hand. Affects serve angles, forehand/backhand court coverage, and cross-court dynamics."
    },
    "elo": {
      "type": "integer",
      "minimum": 0,
      "description": "Starting ELO rating. Optional — players without ELO are seeded last (randomly) in tournaments. Once the ELO ledger exists, the ledger value takes precedence over this field."
    },
    "decisionEngine": {
      "type": "string",
      "description": "Which player engine implementation to use for this player. Defaults to 'default'. The default engine uses strokeTendencies + serveTendencies + attributes to make decisions. Custom engines may interpret player data differently or ignore some fields entirely.",
      "default": "default"
    },
    "attributes": {
      "type": "object",
      "description": "Global attributes that affect all shots and overall play. Scale: 0 (no ability) to 100 (theoretical human peak).",
      "required": ["footwork", "reaction", "spinRead", "deception", "stamina", "mental", "service", "adaptability"],
      "additionalProperties": false,
      "properties": {
        "footwork": {
          "type": "integer",
          "minimum": 0,
          "maximum": 100,
          "description": "Recovery speed between shots and ability to reach wide balls. Determines how far toward the recovery position the player moves before the next ball arrives. High footwork = rarely caught out of position."
        },
        "reaction": {
          "type": "integer",
          "minimum": 0,
          "maximum": 100,
          "description": "Response time to fast shots. Affects time pressure degradation — a player with high reaction handles fast incoming balls with less quality loss."
        },
        "spinRead": {
          "type": "integer",
          "minimum": 0,
          "maximum": 100,
          "description": "Accuracy of reading incoming spin (direction and magnitude). Defensive skill. Low = novice-level misreads (might mistake backspin for topspin). High = pro-level reads (correctly identifies spin type and weight). The receiver's decisions and execution are based on perceived spin, not actual spin."
        },
        "deception": {
          "type": "integer",
          "minimum": 0,
          "maximum": 100,
          "description": "Ability to disguise spin (same arm motion for different spins). Offensive skill. High = opponents can't tell what spin was applied. Interacts with spin variation: wide variation + high deception is devastating, wide variation + low deception is readable."
        },
        "stamina": {
          "type": "integer",
          "minimum": 0,
          "maximum": 100,
          "description": "Resistance to fatigue over long matches. As stamina depletes, all physical capabilities degrade subtly. High stamina = maintains peak performance deeper into matches."
        },
        "mental": {
          "type": "integer",
          "minimum": 0,
          "maximum": 100,
          "description": "Performance under pressure. Affects play quality in high-stakes situations: deuce, match point, comebacks, decisive games. Low mental = chokes under pressure. High mental = thrives in clutch moments."
        },
        "service": {
          "type": "integer",
          "minimum": 0,
          "maximum": 100,
          "description": "Serve execution skill. Determines how closely the actual serve matches the player's intended serve properties (speed, spin, placement). Also inherently makes serves harder to read — a skilled server can place the ball tighter to the net/edges and generate more extreme spin."
        },
        "adaptability": {
          "type": "integer",
          "minimum": 0,
          "maximum": 100,
          "description": "How quickly the player adjusts tactics mid-match based on what's working or failing. High = reads the game well and shifts tendencies quickly. Low = stubbornly sticks to their game plan even when it's failing. Affects both stroke and serve tendencies during a match."
        }
      }
    },
    "equipment": {
      "type": "object",
      "description": "Paddle equipment configuration. Forehand/backhand rubber maps to the corresponding side in strokeCapabilities. Rubber type fundamentally changes viable shots and ball behavior.",
      "required": ["blade", "forehandRubber", "backhandRubber"],
      "additionalProperties": false,
      "properties": {
        "blade": {
          "type": "object",
          "description": "The paddle blade (wooden core).",
          "required": ["speed"],
          "additionalProperties": false,
          "properties": {
            "speed": {
              "type": "integer",
              "minimum": 0,
              "maximum": 100,
              "description": "Blade speed rating. Affects how much pace the player can generate. Carbon blades rate higher; all-wood blades rate lower but offer more control."
            }
          }
        },
        "forehandRubber": {
          "$ref": "#/$defs/rubber",
          "description": "Rubber on the forehand side of the paddle."
        },
        "backhandRubber": {
          "$ref": "#/$defs/rubber",
          "description": "Rubber on the backhand side of the paddle."
        }
      }
    },
    "strokeCapabilities": {
      "type": "object",
      "description": "Physical ceilings for each side (forehand/backhand). The closer a player pushes toward these ceilings in a shot, the higher the risk of execution error. Equipment rubber modifies effective ceilings at runtime.",
      "required": ["forehand", "backhand"],
      "additionalProperties": false,
      "properties": {
        "forehand": {
          "$ref": "#/$defs/sideCapabilities",
          "description": "Forehand side physical ceilings. Combined with forehandRubber at runtime."
        },
        "backhand": {
          "$ref": "#/$defs/sideCapabilities",
          "description": "Backhand side physical ceilings. Combined with backhandRubber at runtime."
        }
      }
    },
    "strokeTendencies": {
      "type": "object",
      "description": "Playstyle DNA for rally shots. Continuous tendencies (0-100) that describe what the player TRIES to do. No named shot types — shots are defined by physical properties, and labels like 'loop' or 'chop' emerge naturally from the combination of tendencies. These are BASE values consumed by the default player engine; the engine adjusts them mid-match based on adaptability. Custom player engines may interpret or ignore these.",
      "required": ["powerBias", "spinIntensity", "topspinBias", "sidespinUsage", "depthBias", "netClearance", "riskTolerance"],
      "additionalProperties": false,
      "properties": {
        "powerBias": {
          "type": "integer",
          "minimum": 0,
          "maximum": 100,
          "description": "How hard the player typically hits (0 = soft touch, 100 = full power). Low = control-oriented play, high = aggressive attacking."
        },
        "spinIntensity": {
          "type": "integer",
          "minimum": 0,
          "maximum": 100,
          "description": "How much spin the player typically applies (0 = flat hitting, 100 = heavy spin on every shot). High values combined with high spinCeiling = heavy spin player."
        },
        "topspinBias": {
          "type": "integer",
          "minimum": 0,
          "maximum": 100,
          "description": "Spin direction bias (0 = backspin dominant, 50 = flat/mixed, 100 = topspin dominant). A chopper sits around 15-25; a looper sits around 75-90."
        },
        "sidespinUsage": {
          "type": "integer",
          "minimum": 0,
          "maximum": 100,
          "description": "How much sidespin is mixed into rally shots (0 = pure top/backspin, 100 = heavy sidespin on every shot). Most players are low (10-30); specialist styles may go higher."
        },
        "depthBias": {
          "type": "integer",
          "minimum": 0,
          "maximum": 100,
          "description": "Shot depth preference (0 = short game near the net, 100 = deep driving game). Short game is safer but gives less pressure; deep game pushes opponent back."
        },
        "netClearance": {
          "type": "integer",
          "minimum": 0,
          "maximum": 100,
          "description": "Trajectory height preference (0 = net-skimming, 100 = high arc). Low = aggressive/risky (might clip net), high = safe but attackable (opponent gets a high ball). Choppers tend high; drivers tend low."
        },
        "riskTolerance": {
          "type": "integer",
          "minimum": 0,
          "maximum": 100,
          "description": "Overall willingness to push toward ceilings and aim for lines (0 = conservative, always plays safe, 100 = gambler, always goes for the corner). Low risk = safe placement + comfortable effort = easy ball for opponent. High risk = tight placement + max effort = either a winner or an error."
        }
      }
    },
    "serveTendencies": {
      "type": "object",
      "description": "Serve tendency profile. Continuous physical tendencies (0-100) that define what kinds of serves the player attempts. The engine samples from these to generate each serve's intended properties, then applies error based on the service attribute. Base values adjusted mid-match by adaptability.",
      "required": ["length", "speed", "spinAmount", "spinVariation", "backspinBias", "sidespinBias", "risk"],
      "additionalProperties": false,
      "properties": {
        "length": {
          "type": "integer",
          "minimum": 0,
          "maximum": 100,
          "description": "Placement depth tendency. 0 = always serves short (near the net, low bounce, hard to attack). 100 = always serves long (deep to the end of the table, rushes opponent). 50 = balanced mix."
        },
        "speed": {
          "type": "integer",
          "minimum": 0,
          "maximum": 100,
          "description": "Serve speed tendency. 0 = slow serves (maximizes spin and control). 100 = fast serves (rushes opponent but less spin)."
        },
        "spinAmount": {
          "type": "integer",
          "minimum": 0,
          "maximum": 100,
          "description": "Spin magnitude tendency. 0 = minimal spin (flat serves). 100 = heavy spin on every serve."
        },
        "spinVariation": {
          "type": "integer",
          "minimum": 0,
          "maximum": 100,
          "description": "How much the spin direction and magnitude changes serve-to-serve. 0 = same spin every time (predictable). 100 = wildly varied (hard to read, requires high service skill to control). Interacts with deception."
        },
        "backspinBias": {
          "type": "integer",
          "minimum": 0,
          "maximum": 100,
          "description": "Tendency toward backspin vs topspin. 0 = pure topspin serves. 50 = equal mix. 100 = pure backspin serves."
        },
        "sidespinBias": {
          "type": "integer",
          "minimum": 0,
          "maximum": 100,
          "description": "How much sidespin is added to serves. 0 = no sidespin. 100 = heavy sidespin on every serve."
        },
        "risk": {
          "type": "integer",
          "minimum": 0,
          "maximum": 100,
          "description": "Serve aggression. 0 = safe serves (comfortable margins from net and edges). 100 = aggressive serves (tight to the net, close to edges, more aces but more faults)."
        }
      }
    },
    "badges": {
      "type": "array",
      "items": {
        "type": "string",
        "minLength": 1
      },
      "uniqueItems": true,
      "description": "Optional array of badge identifiers that modify simulation calculations. Badges can be positive (buffs) or negative (flaws). The badge system is designed but not active in Phase 1 — this field is accepted but ignored until badges are implemented.",
      "default": []
    }
  },
  "$defs": {
    "rubber": {
      "type": "object",
      "description": "Paddle rubber configuration. Rubber type fundamentally changes what shots are viable and how the ball behaves off the bat.",
      "required": ["type", "spin", "speed", "control"],
      "additionalProperties": false,
      "properties": {
        "type": {
          "type": "string",
          "enum": ["inverted", "shortPips", "longPips", "antispin"],
          "description": "Rubber surface type. inverted = smooth, grippy, maximum spin (most common). shortPips = small pimples out, less spin-sensitive, good for flat hitting. longPips = long pimples out, reverses incoming spin, disrupts opponents. antispin = slick surface, minimal friction, deadens spin."
        },
        "spin": {
          "type": "integer",
          "minimum": 0,
          "maximum": 100,
          "description": "Spin generation capability. How much spin the rubber can impart on the ball."
        },
        "speed": {
          "type": "integer",
          "minimum": 0,
          "maximum": 100,
          "description": "Speed capability. How much pace the rubber adds to shots."
        },
        "control": {
          "type": "integer",
          "minimum": 0,
          "maximum": 100,
          "description": "Control rating. How predictable and precise shots are off this rubber. Typically inversely correlated with speed."
        }
      }
    },
    "sideCapabilities": {
      "type": "object",
      "description": "Physical ceilings for one side of the paddle (forehand or backhand). Scale: 0 (no ability) to 100 (theoretical human peak). The closer a player's intention is to these ceilings, the higher the execution risk.",
      "required": ["powerCeiling", "spinCeiling", "accuracy", "consistency"],
      "additionalProperties": false,
      "properties": {
        "powerCeiling": {
          "type": "integer",
          "minimum": 0,
          "maximum": 100,
          "description": "Maximum power this side can generate. Equipment (blade speed + rubber speed) modifies the effective ceiling at runtime."
        },
        "spinCeiling": {
          "type": "integer",
          "minimum": 0,
          "maximum": 100,
          "description": "Maximum spin this side can generate. Equipment (rubber spin + rubber type) modifies the effective ceiling at runtime."
        },
        "accuracy": {
          "type": "integer",
          "minimum": 0,
          "maximum": 100,
          "description": "Base placement accuracy at comfortable effort. Determines the width of the Gaussian error distribution around the intended target. Degrades as the player pushes toward ceilings or plays under duress."
        },
        "consistency": {
          "type": "integer",
          "minimum": 0,
          "maximum": 100,
          "description": "Shot-to-shot reliability. How often the player executes at their skill level vs making an error. Low = occasional shanks and mishits even in ideal conditions."
        }
      }
    }
  }
}
